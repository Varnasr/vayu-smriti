<!DOCTYPE html>
<html lang="en" data-theme="light" data-lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vayu Smriti ‡§µ‡§æ‡§Ø‡•Å ‡§∏‡•ç‡§Æ‡•É‡§§‡§ø | India's Air Quality Archive</title>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=Noto+Sans+Devanagari:wght@400;600&family=Noto+Sans+Tamil:wght@400;600&family=Noto+Sans+Bengali:wght@400;600&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary: #7C3AED; --primary-light: #A78BFA; --accent: #F59E0B;
            --text: #1F2937; --text-2: #4B5563; --text-3: #9CA3AF;
            --bg: #F8FAFC; --card: #FFFFFF; --border: #E2E8F0;
            --health: #EF4444; --policy: #3B82F6; --research: #10B981; --testimony: #F59E0B;
            --aqi-good: #22C55E; --aqi-mod: #EAB308; --aqi-poor: #F97316; --aqi-vpoor: #EF4444; --aqi-severe: #7C3AED; --aqi-hazard: #831843;
            --gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        [data-theme="dark"] {
            --text: #F1F5F9; --text-2: #CBD5E1; --text-3: #64748B;
            --bg: #0F172A; --card: #1E293B; --border: #334155;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'DM Sans', 'Noto Sans Devanagari', system-ui, sans-serif; background: var(--bg); color: var(--text); line-height: 1.5; font-size: 14px; }
        
        [data-lang="en"] .hi, [data-lang="en"] .ta, [data-lang="en"] .bn, [data-lang="en"] .mr { display: none; }
        [data-lang="hi"] .en, [data-lang="hi"] .ta, [data-lang="hi"] .bn, [data-lang="hi"] .mr { display: none; }
        [data-lang="ta"] .en, [data-lang="ta"] .hi, [data-lang="ta"] .bn, [data-lang="ta"] .mr { display: none; }
        [data-lang="bn"] .en, [data-lang="bn"] .hi, [data-lang="bn"] .ta, [data-lang="bn"] .mr { display: none; }
        [data-lang="mr"] .en, [data-lang="mr"] .hi, [data-lang="mr"] .ta, [data-lang="mr"] .bn { display: none; }

        /* HEADER - Compact */
        .header { background: var(--card); border-bottom: 1px solid var(--border); padding: 0.5rem 1rem; position: sticky; top: 0; z-index: 100; }
        .header-inner { max-width: 1600px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center; gap: 0.5rem; }
        .logo { display: flex; align-items: center; gap: 0.5rem; }
        .logo-mark { width: 32px; height: 32px; background: var(--gradient); border-radius: 8px; display: flex; align-items: center; justify-content: center; }
        .logo-mark svg { width: 18px; height: 18px; color: white; }
        .logo h1 { font-size: 1rem; font-weight: 700; background: var(--gradient); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .header-actions { display: flex; gap: 0.375rem; align-items: center; }
        .btn { padding: 0.375rem 0.75rem; border-radius: 6px; font-size: 0.75rem; font-weight: 500; cursor: pointer; border: none; font-family: inherit; display: inline-flex; align-items: center; gap: 0.25rem; transition: all 0.2s; text-decoration: none; }
        .btn-icon { padding: 0.375rem; background: transparent; border: 1px solid var(--border); color: var(--text-2); border-radius: 6px; }
        .btn-icon:hover { border-color: var(--primary); color: var(--primary); }
        .btn-primary { background: var(--gradient); color: white; }
        .lang-select { padding: 0.25rem 0.5rem; border-radius: 4px; border: 1px solid var(--border); background: var(--card); color: var(--text); font-size: 0.75rem; }

        /* TICKER */
        .ticker { background: linear-gradient(90deg, #1E293B, #0F172A); padding: 0.5rem 1rem; overflow-x: auto; }
        .ticker-inner { max-width: 1600px; margin: 0 auto; display: flex; align-items: center; gap: 1rem; }
        .ticker-label { font-size: 0.625rem; text-transform: uppercase; letter-spacing: 1px; color: #94A3B8; white-space: nowrap; display: flex; align-items: center; gap: 0.25rem; }
        .pulse { width: 6px; height: 6px; background: #EF4444; border-radius: 50%; animation: pulse 2s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.4; } }
        .ticker-scroll { display: flex; gap: 1rem; flex: 1; overflow-x: auto; }
        .ticker-scroll::-webkit-scrollbar { display: none; }
        .ticker-item { display: flex; align-items: center; gap: 0.375rem; white-space: nowrap; }
        .ticker-city { font-size: 0.6875rem; color: #CBD5E1; }
        .ticker-aqi { font-size: 0.75rem; font-weight: 700; padding: 0.125rem 0.375rem; border-radius: 3px; min-width: 36px; text-align: center; color: white; }
        .ticker-aqi.good { background: var(--aqi-good); } .ticker-aqi.mod { background: var(--aqi-mod); color: #1F2937; }
        .ticker-aqi.poor { background: var(--aqi-poor); } .ticker-aqi.vpoor { background: var(--aqi-vpoor); } 
        .ticker-aqi.severe { background: var(--aqi-severe); } .ticker-aqi.hazard { background: var(--aqi-hazard); }
        .ticker-update { font-size: 0.5625rem; color: #64748B; margin-left: auto; white-space: nowrap; }

        /* MAIN LAYOUT - 3 Column */
        .main { max-width: 1600px; margin: 0 auto; padding: 1rem; display: grid; grid-template-columns: 280px 1fr 300px; gap: 1rem; }
        @media (max-width: 1200px) { .main { grid-template-columns: 1fr 280px; } .sidebar-left { display: none; } }
        @media (max-width: 800px) { .main { grid-template-columns: 1fr; } .sidebar-right { display: none; } }

        /* SIDEBAR LEFT - Navigation & Stats */
        .sidebar-left { display: flex; flex-direction: column; gap: 0.75rem; }
        .stat-card { background: var(--card); border: 1px solid var(--border); border-radius: 8px; padding: 0.75rem; }
        .stat-value { font-size: 1.5rem; font-weight: 700; color: var(--primary); }
        .stat-label { font-size: 0.6875rem; color: var(--text-3); text-transform: uppercase; letter-spacing: 0.5px; }
        .nav-section { background: var(--card); border: 1px solid var(--border); border-radius: 8px; padding: 0.5rem; }
        .nav-title { font-size: 0.625rem; text-transform: uppercase; letter-spacing: 0.5px; color: var(--text-3); padding: 0.375rem 0.5rem; }
        .nav-item { display: flex; align-items: center; gap: 0.5rem; padding: 0.5rem; border-radius: 6px; cursor: pointer; font-size: 0.8125rem; color: var(--text-2); transition: all 0.15s; }
        .nav-item:hover { background: var(--bg); color: var(--text); }
        .nav-item.active { background: var(--primary); color: white; }
        .nav-item svg { width: 16px; height: 16px; }
        .nav-badge { margin-left: auto; font-size: 0.625rem; background: var(--bg); padding: 0.125rem 0.375rem; border-radius: 4px; }
        .nav-item.active .nav-badge { background: rgba(255,255,255,0.2); }

        /* CENTER CONTENT */
        .content { display: flex; flex-direction: column; gap: 1rem; }
        .panel { display: none; }
        .panel.active { display: flex; flex-direction: column; gap: 1rem; }

        /* CARDS - Compact */
        .card { background: var(--card); border: 1px solid var(--border); border-radius: 8px; overflow: hidden; }
        .card-header { padding: 0.625rem 0.75rem; border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; }
        .card-title { font-size: 0.8125rem; font-weight: 600; display: flex; align-items: center; gap: 0.375rem; }
        .card-title svg { width: 14px; height: 14px; color: var(--primary); }
        .card-body { padding: 0.75rem; }
        .card-footer { padding: 0.5rem 0.75rem; border-top: 1px solid var(--border); background: var(--bg); }

        /* NEWS FEED */
        .news-item { padding: 0.625rem 0; border-bottom: 1px solid var(--border); }
        .news-item:last-child { border-bottom: none; }
        .news-source { font-size: 0.5625rem; text-transform: uppercase; letter-spacing: 0.5px; color: var(--primary); font-weight: 600; }
        .news-title { font-size: 0.8125rem; font-weight: 500; line-height: 1.4; margin: 0.25rem 0; }
        .news-title a { color: var(--text); text-decoration: none; }
        .news-title a:hover { color: var(--primary); }
        .news-meta { font-size: 0.6875rem; color: var(--text-3); }
        .news-loading { text-align: center; padding: 2rem; color: var(--text-3); }
        .news-error { text-align: center; padding: 1rem; color: var(--health); font-size: 0.75rem; }

        /* RESOURCE LIST - Compact */
        .resource-list { display: flex; flex-direction: column; }
        .resource-item { display: flex; gap: 0.625rem; padding: 0.625rem 0; border-bottom: 1px solid var(--border); }
        .resource-item:last-child { border-bottom: none; }
        .resource-icon { width: 32px; height: 32px; border-radius: 6px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; }
        .resource-icon svg { width: 14px; height: 14px; }
        .resource-icon.health { background: #FEE2E2; color: var(--health); }
        .resource-icon.policy { background: #DBEAFE; color: var(--policy); }
        .resource-icon.research { background: #D1FAE5; color: var(--research); }
        .resource-icon.testimony { background: #FEF3C7; color: var(--testimony); }
        .resource-content { flex: 1; min-width: 0; }
        .resource-type { font-size: 0.5625rem; text-transform: uppercase; letter-spacing: 0.5px; color: var(--text-3); }
        .resource-title { font-size: 0.8125rem; font-weight: 500; line-height: 1.3; }
        .resource-title a { color: var(--text); text-decoration: none; }
        .resource-title a:hover { color: var(--primary); }
        .resource-meta { font-size: 0.6875rem; color: var(--text-3); margin-top: 0.25rem; }

        /* SEARCH */
        .search-box { display: flex; gap: 0.5rem; margin-bottom: 0.75rem; }
        .search-input { flex: 1; padding: 0.5rem 0.75rem; border: 1px solid var(--border); border-radius: 6px; font-size: 0.8125rem; background: var(--card); color: var(--text); }
        .search-input:focus { outline: none; border-color: var(--primary); }
        .filter-pills { display: flex; gap: 0.375rem; flex-wrap: wrap; margin-bottom: 0.75rem; }
        .filter-pill { padding: 0.25rem 0.625rem; border-radius: 4px; font-size: 0.6875rem; border: 1px solid var(--border); background: var(--card); color: var(--text-2); cursor: pointer; }
        .filter-pill:hover, .filter-pill.active { background: var(--primary); color: white; border-color: var(--primary); }

        /* CHARTS */
        .chart-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 0.75rem; }
        @media (max-width: 600px) { .chart-grid { grid-template-columns: 1fr; } }
        .chart-container { height: 180px; }

        /* SIDEBAR RIGHT */
        .sidebar-right { display: flex; flex-direction: column; gap: 0.75rem; }

        /* MEDICAL GLOSSARY */
        .glossary-item { padding: 0.5rem 0; border-bottom: 1px solid var(--border); }
        .glossary-item:last-child { border-bottom: none; }
        .glossary-term { font-size: 0.8125rem; font-weight: 600; color: var(--primary); }
        .glossary-def { font-size: 0.75rem; color: var(--text-2); margin-top: 0.125rem; }

        /* AQI SCALE */
        .aqi-scale { display: flex; flex-direction: column; gap: 0.375rem; }
        .aqi-level { display: flex; align-items: center; gap: 0.5rem; padding: 0.375rem; border-radius: 4px; font-size: 0.6875rem; }
        .aqi-level-color { width: 12px; height: 12px; border-radius: 2px; }
        .aqi-level-range { font-weight: 600; min-width: 50px; }
        .aqi-level-label { color: var(--text-2); }

        /* HEALTH ADVICE */
        .advice-card { background: linear-gradient(135deg, #FEF3C7, #FDE68A); border: 1px solid #F59E0B; border-radius: 8px; padding: 0.75rem; }
        [data-theme="dark"] .advice-card { background: linear-gradient(135deg, #78350F, #92400E); }
        .advice-title { font-size: 0.75rem; font-weight: 600; color: #92400E; margin-bottom: 0.5rem; display: flex; align-items: center; gap: 0.375rem; }
        [data-theme="dark"] .advice-title { color: #FDE68A; }
        .advice-list { font-size: 0.6875rem; color: #78350F; }
        [data-theme="dark"] .advice-list { color: #FCD34D; }
        .advice-list li { margin-bottom: 0.25rem; }

        /* TIMELINE */
        .timeline { display: flex; flex-direction: column; }
        .timeline-item { display: flex; gap: 0.5rem; padding: 0.5rem 0; border-bottom: 1px solid var(--border); }
        .timeline-item:last-child { border-bottom: none; }
        .timeline-date { font-size: 0.5625rem; color: var(--text-3); min-width: 45px; }
        .timeline-content { flex: 1; }
        .timeline-title { font-size: 0.75rem; font-weight: 500; }
        .timeline-desc { font-size: 0.6875rem; color: var(--text-2); }
        .tag { display: inline-block; font-size: 0.5rem; padding: 0.0625rem 0.25rem; border-radius: 2px; font-weight: 600; text-transform: uppercase; margin-left: 0.25rem; }
        .tag-policy { background: #DBEAFE; color: var(--policy); }
        .tag-legal { background: #FEE2E2; color: var(--health); }

        /* TESTIMONIES */
        .testimony-item { padding: 0.625rem; background: var(--bg); border-radius: 6px; border-left: 3px solid var(--testimony); margin-bottom: 0.5rem; }
        .testimony-quote { font-size: 0.8125rem; font-style: italic; line-height: 1.4; }
        .testimony-author { font-size: 0.6875rem; color: var(--text-2); margin-top: 0.375rem; }

        /* FOOTER */
        .footer { background: var(--card); border-top: 1px solid var(--border); padding: 1rem; margin-top: 1rem; }
        .footer-inner { max-width: 1600px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 0.5rem; font-size: 0.75rem; color: var(--text-2); }
        .footer-links { display: flex; gap: 1rem; }
        .footer-links a { color: var(--text-2); text-decoration: none; }
        .footer-links a:hover { color: var(--primary); }

        /* LIVE INDICATOR */
        .live-badge { display: inline-flex; align-items: center; gap: 0.25rem; font-size: 0.5625rem; text-transform: uppercase; letter-spacing: 0.5px; color: var(--aqi-good); }
        .live-badge::before { content: ''; width: 6px; height: 6px; background: var(--aqi-good); border-radius: 50%; animation: pulse 2s infinite; }

        /* WHO BANNER */
        .who-banner { background: linear-gradient(135deg, #DBEAFE, #BFDBFE); border: 1px solid #3B82F6; border-radius: 8px; padding: 0.75rem; margin-bottom: 0.75rem; }
        [data-theme="dark"] .who-banner { background: linear-gradient(135deg, #1E3A5F, #1E40AF); }
        .who-title { font-size: 0.6875rem; font-weight: 600; color: #1E40AF; display: flex; align-items: center; gap: 0.25rem; }
        [data-theme="dark"] .who-title { color: #93C5FD; }
        .who-content { font-size: 0.75rem; color: #1E3A8A; margin-top: 0.25rem; }
        [data-theme="dark"] .who-content { color: #BFDBFE; }
        .who-link { font-size: 0.6875rem; color: #2563EB; text-decoration: none; margin-top: 0.375rem; display: inline-block; }
        .who-link:hover { text-decoration: underline; }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-inner">
            <div class="logo">
                <div class="logo-mark"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg></div>
                <h1>Vayu Smriti <span class="hi">‡§µ‡§æ‡§Ø‡•Å ‡§∏‡•ç‡§Æ‡•É‡§§‡§ø</span></h1>
            </div>
            <div class="header-actions">
                <button class="btn-icon" onclick="toggleTheme()" title="Toggle theme">
                    <svg id="theme-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg>
                </button>
                <select class="lang-select" onchange="setLang(this.value)">
                    <option value="en">EN</option>
                    <option value="hi">‡§π‡§ø‡§Ç‡§¶‡•Ä</option>
                    <option value="ta">‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç</option>
                    <option value="bn">‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ</option>
                    <option value="mr">‡§Æ‡§∞‡§æ‡§†‡•Ä</option>
                </select>
                <button class="btn btn-primary">+ Share Story</button>
            </div>
        </div>
    </header>

    <div class="ticker">
        <div class="ticker-inner">
            <div class="ticker-label"><span class="pulse"></span> LIVE AQI</div>
            <div class="ticker-scroll" id="aqi-ticker">
                <!-- Populated by JavaScript -->
                <div class="ticker-item"><span class="ticker-city">Connecting...</span></div>
            </div>
            <button onclick="manualRefresh()" class="btn-icon" style="padding: 0.25rem 0.5rem; font-size: 0.625rem; margin-left: 0.5rem;" title="Refresh AQI data">‚Üª Refresh Now</button>
            <div class="ticker-update" id="ticker-update">Initializing...</div>
        </div>
    </div>

    <main class="main">
        <!-- LEFT SIDEBAR -->
        <aside class="sidebar-left">
            <div class="stat-card">
                <div class="stat-value">2.1M</div>
                <div class="stat-label">Deaths/Year (India)</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" style="color: var(--health);">0</div>
                <div class="stat-label">Good AQI Days Delhi 2025</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" style="color: var(--accent);">$150B</div>
                <div class="stat-label">Annual Economic Loss</div>
            </div>

            <nav class="nav-section">
                <div class="nav-title">Archive</div>
                <div class="nav-item active" onclick="showPanel('news')">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M19 20H5a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v1m2 13a2 2 0 0 1-2-2V7m2 13a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2"/></svg>
                    Live News
                    <span class="nav-badge live-badge">Live</span>
                </div>
                <div class="nav-item" onclick="showPanel('health')">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/></svg>
                    Health Burden
                    <span class="nav-badge">12</span>
                </div>
                <div class="nav-item" onclick="showPanel('policy')">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/></svg>
                    Policy & Legal
                    <span class="nav-badge">8</span>
                </div>
                <div class="nav-item" onclick="showPanel('research')">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg>
                    Research
                    <span class="nav-badge">15</span>
                </div>
                <div class="nav-item" onclick="showPanel('testimonies')">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/></svg>
                    Testimonies
                    <span class="nav-badge">24</span>
                </div>
                <div class="nav-item" onclick="showPanel('data')">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="20" x2="18" y2="10"/><line x1="12" y1="20" x2="12" y2="4"/><line x1="6" y1="20" x2="6" y2="14"/></svg>
                    Live Data
                    <span class="nav-badge live-badge">Live</span>
                </div>
            </nav>

            <nav class="nav-section">
                <div class="nav-title">Quick Links</div>
                <div class="nav-item" onclick="showPanel('glossary')">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>
                    Medical Glossary
                </div>
                <div class="nav-item" onclick="window.open('https://www.who.int/publications/i/item/9789240034228')">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>
                    WHO Guidelines
                </div>
            </nav>
        </aside>

        <!-- CENTER CONTENT -->
        <section class="content">
            <!-- NEWS PANEL -->
            <div class="panel active" id="panel-news">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M19 20H5a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v1m2 13a2 2 0 0 1-2-2V7m2 13a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2"/></svg>
                            Live Air Quality News
                        </h2>
                        <span class="live-badge">Auto-updating</span>
                    </div>
                    <div class="card-body" id="news-feed">
                        <div class="news-loading">Loading latest news...</div>
                    </div>
                    <div class="card-footer" style="font-size: 0.6875rem; color: var(--text-3);">
                        Sources: Google News, Down to Earth, Indian Express, Times of India ‚Ä¢ Updates every 15 minutes
                    </div>
                </div>

                <div class="chart-grid">
                    <div class="card">
                        <div class="card-header"><h3 class="card-title">Metro Cities AQI</h3></div>
                        <div class="card-body"><div class="chart-container"><canvas id="metroChart"></canvas></div></div>
                    </div>
                    <div class="card">
                        <div class="card-header"><h3 class="card-title">North vs South India</h3></div>
                        <div class="card-body"><div class="chart-container"><canvas id="regionChart"></canvas></div></div>
                    </div>
                </div>
            </div>

            <!-- HEALTH PANEL -->
            <div class="panel" id="panel-health">
                <div class="who-banner">
                    <div class="who-title">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 16v-4M12 8h.01"/></svg>
                        WHO Air Quality Guidelines (2021)
                    </div>
                    <div class="who-content">
                        PM2.5: <strong>5 ¬µg/m¬≥</strong> annual mean (Delhi avg: 100+ ¬µg/m¬≥ = 20x over limit)<br>
                        PM10: <strong>15 ¬µg/m¬≥</strong> annual mean ‚Ä¢ O‚ÇÉ: <strong>100 ¬µg/m¬≥</strong> 8-hour mean
                    </div>
                    <a href="https://www.who.int/publications/i/item/9789240034228" class="who-link" target="_blank">Read full WHO guidelines ‚Üí</a>
                </div>

                <div class="search-box">
                    <input type="text" class="search-input" placeholder="Search health studies..." id="search-health" onkeyup="filterResources('health')">
                </div>
                <div class="filter-pills">
                    <span class="filter-pill active">All</span>
                    <span class="filter-pill">GBD Studies</span>
                    <span class="filter-pill">Mortality</span>
                    <span class="filter-pill">Children</span>
                    <span class="filter-pill">Economic</span>
                </div>

                <div class="card">
                    <div class="card-body">
                        <div class="resource-list" id="health-resources">
                            <div class="resource-item">
                                <div class="resource-icon health"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 12h-4l-3 9L9 3l-3 9H2"/></svg></div>
                                <div class="resource-content">
                                    <div class="resource-type">Lancet Planetary Health ‚Ä¢ GBD 2019</div>
                                    <div class="resource-title"><a href="https://www.thelancet.com/journals/lanplh/article/PIIS2542-5196(20)30298-9/fulltext" target="_blank">Health and Economic Impact of Air Pollution in the States of India</a></div>
                                    <div class="resource-meta">1.67M deaths ‚Ä¢ 17.8% of total deaths ‚Ä¢ State-level data ‚Ä¢ Open Access</div>
                                </div>
                            </div>
                            <div class="resource-item">
                                <div class="resource-icon health"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/></svg></div>
                                <div class="resource-content">
                                    <div class="resource-type">Health Effects Institute ‚Ä¢ IHME 2024</div>
                                    <div class="resource-title"><a href="https://www.healthdata.org/sites/default/files/2024-06/soga-2024-report.pdf" target="_blank">State of Global Air 2024: Focus on Children's Health</a></div>
                                    <div class="resource-meta">8.1M deaths globally ‚Ä¢ 700K+ children under 5 ‚Ä¢ PDF Download</div>
                                </div>
                            </div>
                            <div class="resource-item">
                                <div class="resource-icon health"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/><path d="M3 9h18M9 21V9"/></svg></div>
                                <div class="resource-content">
                                    <div class="resource-type">IHME Interactive Tool</div>
                                    <div class="resource-title"><a href="https://vizhub.healthdata.org/gbd-results/" target="_blank">Global Burden of Disease ‚Äî Data Visualization</a></div>
                                    <div class="resource-meta">Deaths, DALYs by state, age, sex (1990-2021) ‚Ä¢ Interactive ‚Ä¢ Downloadable</div>
                                </div>
                            </div>
                            <div class="resource-item">
                                <div class="resource-icon health"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/></svg></div>
                                <div class="resource-content">
                                    <div class="resource-type">AQI.in Analysis ‚Ä¢ Dec 2025</div>
                                    <div class="resource-title"><a href="https://www.aqi.in/blog/delhi-air-quality-2025-zero-good-days/" target="_blank">Delhi 2025: Zero Good Air Quality Days</a></div>
                                    <div class="resource-meta">75% days unhealthy ‚Ä¢ No safe breathing day ‚Ä¢ Daily analysis</div>
                                </div>
                            </div>
                            <div class="resource-item">
                                <div class="resource-icon health"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg></div>
                                <div class="resource-content">
                                    <div class="resource-type">Nature Scientific Reports</div>
                                    <div class="resource-title"><a href="https://www.nature.com/articles/s41598-021-02232-z" target="_blank">Premature Mortality in 31 Million-Plus Non-Attainment Cities</a></div>
                                    <div class="resource-meta">80,447 deaths ‚Ä¢ IHD 47% of total ‚Ä¢ GEMM model ‚Ä¢ Open Access</div>
                                </div>
                            </div>
                            <div class="resource-item">
                                <div class="resource-icon health"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg></div>
                                <div class="resource-content">
                                    <div class="resource-type">Our World in Data</div>
                                    <div class="resource-title"><a href="https://ourworldindata.org/air-pollution" target="_blank">Air Pollution ‚Äî Deaths, Exposure, and Health Impacts</a></div>
                                    <div class="resource-meta">Global + India data ‚Ä¢ Charts & maps ‚Ä¢ Open data</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- POLICY PANEL -->
            <div class="panel" id="panel-policy">
                <div class="search-box">
                    <input type="text" class="search-input" placeholder="Search policies, court orders...">
                </div>
                <div class="filter-pills">
                    <span class="filter-pill active">All</span>
                    <span class="filter-pill">GRAP</span>
                    <span class="filter-pill">NCAP</span>
                    <span class="filter-pill">Supreme Court</span>
                    <span class="filter-pill">NGT</span>
                </div>
                <div class="card">
                    <div class="card-body">
                        <div class="resource-list">
                            <div class="resource-item">
                                <div class="resource-icon policy"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg></div>
                                <div class="resource-content">
                                    <div class="resource-type">CAQM Official Order</div>
                                    <div class="resource-title"><a href="https://caqm.nic.in" target="_blank">GRAP Stage IV ‚Äî 13 Dec 2025</a></div>
                                    <div class="resource-meta">Construction ban ‚Ä¢ Truck restrictions ‚Ä¢ 50% WFH ‚Ä¢ AQI 450+ trigger</div>
                                </div>
                            </div>
                            <div class="resource-item">
                                <div class="resource-icon policy"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg></div>
                                <div class="resource-content">
                                    <div class="resource-type">Supreme Court of India</div>
                                    <div class="resource-title"><a href="https://indiankanoon.org/search/?formInput=air%20pollution%20delhi%20vehicles" target="_blank">SC Order on Overage Vehicles ‚Äî 17 Dec 2025</a></div>
                                    <div class="resource-meta">10yr diesel / 15yr petrol ban ‚Ä¢ NCR enforcement</div>
                                </div>
                            </div>
                            <div class="resource-item">
                                <div class="resource-icon policy"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/></svg></div>
                                <div class="resource-content">
                                    <div class="resource-type">MoEFCC</div>
                                    <div class="resource-title"><a href="https://prana.cpcb.gov.in/" target="_blank">National Clean Air Programme (NCAP)</a></div>
                                    <div class="resource-meta">40% PM2.5 reduction by 2026 ‚Ä¢ 132 cities ‚Ä¢ Track on PRANA</div>
                                </div>
                            </div>
                            <div class="resource-item">
                                <div class="resource-icon policy"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/></svg></div>
                                <div class="resource-content">
                                    <div class="resource-type">DPCC / IIT Kanpur</div>
                                    <div class="resource-title"><a href="https://www.dpcc.delhigovt.nic.in/uploads/news/819b9fef9cf4a2a574a10d3bbc421cfd.pdf" target="_blank">Real-Time Source Apportionment Study</a></div>
                                    <div class="resource-meta">Vehicles 23% ‚Ä¢ Biomass 24% ‚Ä¢ Dust 18% ‚Ä¢ PDF Download</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- RESEARCH PANEL -->
            <div class="panel" id="panel-research">
                <div class="search-box">
                    <input type="text" class="search-input" placeholder="Search research papers...">
                </div>
                <div class="card">
                    <div class="card-body">
                        <div class="resource-list">
                            <div class="resource-item">
                                <div class="resource-icon research"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg></div>
                                <div class="resource-content">
                                    <div class="resource-type">TERI-ARAI Study</div>
                                    <div class="resource-title"><a href="https://www.teriin.org/sites/default/files/2018-08/Report_SA_AQM-Delhi-NCR_0.pdf" target="_blank">Source Apportionment of PM2.5 & PM10 ‚Äî Delhi NCR</a></div>
                                    <div class="resource-meta">Road dust 38% ‚Ä¢ Vehicles 20% ‚Ä¢ Domestic 12% ‚Ä¢ Industry 11%</div>
                                </div>
                            </div>
                            <div class="resource-item">
                                <div class="resource-icon research"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg></div>
                                <div class="resource-content">
                                    <div class="resource-type">Urban Emissions / MDPI</div>
                                    <div class="resource-title"><a href="https://urbanemissions.info/wp-content/uploads/docs/2023-02-MDPI-Sus-DelhiAQ-Review.pdf" target="_blank">What Is Polluting Delhi's Air? Review 1990-2022</a></div>
                                    <div class="resource-meta">Comprehensive review ‚Ä¢ All SA studies ‚Ä¢ Peer-reviewed</div>
                                </div>
                            </div>
                            <div class="resource-item">
                                <div class="resource-icon research"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="20" x2="18" y2="10"/><line x1="12" y1="20" x2="12" y2="4"/><line x1="6" y1="20" x2="6" y2="14"/></svg></div>
                                <div class="resource-content">
                                    <div class="resource-type">IIT Delhi / A-PAG ‚Ä¢ Oct 2024</div>
                                    <div class="resource-title"><a href="https://a-pag.org/wp-content/uploads/2024/10/IITDelhi_ImpactAssessment_Report.pdf" target="_blank">Dispersed Sources Program Impact Assessment</a></div>
                                    <div class="resource-meta">15-30% local PM2.5 reduction ‚Ä¢ Targeted interventions</div>
                                </div>
                            </div>
                            <div class="resource-item">
                                <div class="resource-icon research"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2L2 7l10 5 10-5-10-5z"/><path d="M2 17l10 5 10-5"/></svg></div>
                                <div class="resource-content">
                                    <div class="resource-type">CSE Analysis ‚Ä¢ Dec 2025</div>
                                    <div class="resource-title"><a href="https://www.downtoearth.org.in/air/from-episodic-smog-to-structural-pollution-why-vehicles-remain-delhis-biggest-challenge" target="_blank">Vehicles Remain Delhi's Biggest Challenge</a></div>
                                    <div class="resource-meta">51-53% local pollution ‚Ä¢ Year-round source ‚Ä¢ DSS data</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- TESTIMONIES PANEL -->
            <div class="panel" id="panel-testimonies">
                <div class="card">
                    <div class="card-header"><h3 class="card-title">Voices from Social Media</h3></div>
                    <div class="card-body">
                        <div class="testimony-item">
                            <div class="testimony-quote">"Delhi-NCR is ruined, there's no point in defending it anymore. Leaders sit in cabins with air purifiers and say 'this year pollution is less.' The AQI crossed 700 in some areas."</div>
                            <div class="testimony-author">Viral Reddit Post ‚Ä¢ r/india ‚Ä¢ Dec 2025 ‚Ä¢ 10K+ upvotes</div>
                        </div>
                        <div class="testimony-item">
                            <div class="testimony-quote">"Wedding photoshoot in Delhi where love's in the air, but oxygen isn't üò∑"</div>
                            <div class="testimony-author">@sphavisha ‚Ä¢ Twitter/X ‚Ä¢ Nov 2025 ‚Ä¢ Viral</div>
                        </div>
                        <div class="testimony-item">
                            <div class="testimony-quote">"Smoking in Pune is healthier than doing Yoga in Delhi."</div>
                            <div class="testimony-author">@Depresion_Me_hu ‚Ä¢ Twitter/X ‚Ä¢ Nov 2024 ‚Ä¢ Trending</div>
                        </div>
                        <div class="testimony-item">
                            <div class="testimony-quote">"My children have asthma. Doctor says move out of Delhi. But where will I go? This is where I earn."</div>
                            <div class="testimony-author">Ramesh, Auto Driver ‚Ä¢ Mayur Vihar ‚Ä¢ Field Interview</div>
                        </div>
                        <div class="testimony-item">
                            <div class="testimony-quote">"We see 3x respiratory cases in winter. Elderly and children suffer most. Our ventilators run non-stop."</div>
                            <div class="testimony-author">Senior Resident ‚Ä¢ Safdarjung Hospital ‚Ä¢ Dec 2025</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- DATA PANEL -->
            <div class="panel" id="panel-data">
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Live AQI Data</h3>
                        <span class="live-badge">Auto-updating</span>
                    </div>
                    <div class="card-body" id="live-aqi-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 0.5rem;">
                        <!-- Populated by JS -->
                    </div>
                </div>
                <div class="chart-grid">
                    <div class="card">
                        <div class="card-header"><h3 class="card-title">Urban vs Rural (Bihar & UP)</h3></div>
                        <div class="card-body"><div class="chart-container"><canvas id="ruralChart"></canvas></div></div>
                    </div>
                    <div class="card">
                        <div class="card-header"><h3 class="card-title">Delhi AQI Trend ‚Äî Dec 2025</h3></div>
                        <div class="card-body"><div class="chart-container"><canvas id="delhiChart"></canvas></div></div>
                    </div>
                </div>
            </div>

            <!-- GLOSSARY PANEL -->
            <div class="panel" id="panel-glossary">
                <div class="advice-card">
                    <div class="advice-title">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/></svg>
                        When AQI is "Very Poor" (301-400) or "Severe" (401+)
                    </div>
                    <ul class="advice-list">
                        <li>Avoid outdoor exercise, especially for children, elderly, pregnant women</li>
                        <li>Keep windows closed; use air purifiers if available</li>
                        <li>Wear N95/N99 masks outdoors (surgical masks don't filter PM2.5)</li>
                        <li>Stay hydrated; avoid smoking and burning incense indoors</li>
                        <li>Seek medical help if experiencing breathing difficulty, chest pain, persistent cough</li>
                    </ul>
                </div>

                <div class="card">
                    <div class="card-header"><h3 class="card-title">AQI Scale (India NAQI)</h3></div>
                    <div class="card-body">
                        <div class="aqi-scale">
                            <div class="aqi-level"><div class="aqi-level-color" style="background: var(--aqi-good);"></div><div class="aqi-level-range">0-50</div><div class="aqi-level-label">Good ‚Äî Minimal impact</div></div>
                            <div class="aqi-level"><div class="aqi-level-color" style="background: #9ACD32;"></div><div class="aqi-level-range">51-100</div><div class="aqi-level-label">Satisfactory ‚Äî Minor breathing discomfort to sensitive people</div></div>
                            <div class="aqi-level"><div class="aqi-level-color" style="background: var(--aqi-mod);"></div><div class="aqi-level-range">101-200</div><div class="aqi-level-label">Moderate ‚Äî Breathing discomfort to asthma patients, children, elderly</div></div>
                            <div class="aqi-level"><div class="aqi-level-color" style="background: var(--aqi-poor);"></div><div class="aqi-level-range">201-300</div><div class="aqi-level-label">Poor ‚Äî Breathing discomfort on prolonged exposure</div></div>
                            <div class="aqi-level"><div class="aqi-level-color" style="background: var(--aqi-vpoor);"></div><div class="aqi-level-range">301-400</div><div class="aqi-level-label">Very Poor ‚Äî Respiratory illness on prolonged exposure</div></div>
                            <div class="aqi-level"><div class="aqi-level-color" style="background: var(--aqi-severe);"></div><div class="aqi-level-range">401-500</div><div class="aqi-level-label">Severe ‚Äî Affects healthy people; serious impact on those with existing diseases</div></div>
                            <div class="aqi-level"><div class="aqi-level-color" style="background: var(--aqi-hazard);"></div><div class="aqi-level-range">500+</div><div class="aqi-level-label">Hazardous ‚Äî Health emergency, everyone affected</div></div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header"><h3 class="card-title">Key Terms & Definitions</h3></div>
                    <div class="card-body">
                        <div class="glossary-item">
                            <div class="glossary-term">PM2.5 (Fine Particulate Matter)</div>
                            <div class="glossary-def">Particles ‚â§2.5 micrometers. Penetrates deep into lungs and bloodstream. WHO limit: 5 ¬µg/m¬≥ annual, 15 ¬µg/m¬≥ daily. Major causes: vehicles, biomass burning, industry.</div>
                        </div>
                        <div class="glossary-item">
                            <div class="glossary-term">PM10 (Coarse Particulate Matter)</div>
                            <div class="glossary-def">Particles ‚â§10 micrometers. Includes dust, pollen, mold. WHO limit: 15 ¬µg/m¬≥ annual, 45 ¬µg/m¬≥ daily.</div>
                        </div>
                        <div class="glossary-item">
                            <div class="glossary-term">AQI (Air Quality Index)</div>
                            <div class="glossary-def">Standardized measure of air quality. India uses NAQI (National AQI) with 6 categories from 0-500+. Based on 8 pollutants: PM2.5, PM10, NO‚ÇÇ, SO‚ÇÇ, CO, O‚ÇÉ, NH‚ÇÉ, Pb.</div>
                        </div>
                        <div class="glossary-item">
                            <div class="glossary-term">GRAP (Graded Response Action Plan)</div>
                            <div class="glossary-def">Emergency measures for Delhi-NCR. Stage I (Poor): Dust control. Stage II (Very Poor): Diesel generator ban. Stage III (Severe): Construction ban. Stage IV (Severe+): Truck entry ban, 50% WFH.</div>
                        </div>
                        <div class="glossary-item">
                            <div class="glossary-term">Source Apportionment</div>
                            <div class="glossary-def">Scientific method to identify pollution sources (vehicles, dust, industry, biomass). Uses receptor models and chemical analysis of air samples.</div>
                        </div>
                        <div class="glossary-item">
                            <div class="glossary-term">Temperature Inversion</div>
                            <div class="glossary-def">Meteorological condition where warm air traps cold air near ground, preventing pollutants from dispersing. Common in Delhi winters, worsening AQI.</div>
                        </div>
                        <div class="glossary-item">
                            <div class="glossary-term">NCAP (National Clean Air Programme)</div>
                            <div class="glossary-def">India's national policy targeting 40% PM2.5 reduction by 2026 in 132 non-attainment cities. Launched 2019 by MoEFCC.</div>
                        </div>
                    </div>
                    <div class="card-footer">
                        <a href="https://www.who.int/news-room/feature-stories/detail/what-are-the-who-air-quality-guidelines" target="_blank" style="font-size: 0.75rem; color: var(--primary);">Source: WHO Air Quality Guidelines 2021 ‚Üí</a>
                    </div>
                </div>
            </div>
        </section>

        <!-- RIGHT SIDEBAR -->
        <aside class="sidebar-right">
            <div class="card">
                <div class="card-header"><h3 class="card-title">What Changed?</h3></div>
                <div class="card-body">
                    <div class="timeline">
                        <div class="timeline-item">
                            <div class="timeline-date">24 Dec</div>
                            <div class="timeline-content">
                                <div class="timeline-title">GRAP IV Revoked <span class="tag tag-policy">Policy</span></div>
                                <div class="timeline-desc">AQI 271 after favorable winds</div>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-date">17 Dec</div>
                            <div class="timeline-content">
                                <div class="timeline-title">SC Vehicle Hearing <span class="tag tag-legal">Legal</span></div>
                                <div class="timeline-desc">10yr diesel, 15yr petrol ban</div>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-date">14 Dec</div>
                            <div class="timeline-content">
                                <div class="timeline-title">AQI Hits 461</div>
                                <div class="timeline-desc">2nd worst December reading</div>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-date">13 Dec</div>
                            <div class="timeline-content">
                                <div class="timeline-title">GRAP IV Invoked <span class="tag tag-policy">Policy</span></div>
                                <div class="timeline-desc">Construction ban, WFH</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="advice-card">
                <div class="advice-title">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/></svg>
                    Health Advisory
                </div>
                <ul class="advice-list">
                    <li>Avoid outdoor exercise</li>
                    <li>Use N95 masks outside</li>
                    <li>Keep windows closed</li>
                    <li>Run air purifier if available</li>
                    <li>Seek help for breathing issues</li>
                </ul>
            </div>

            <div class="card">
                <div class="card-header"><h3 class="card-title">Data Sources</h3></div>
                <div class="card-body" style="font-size: 0.6875rem; color: var(--text-2);">
                    <p style="margin-bottom: 0.375rem;"><strong>Live AQI:</strong> <a href="https://waqi.info" target="_blank" style="color: var(--primary);">WAQI API</a> (auto-refreshes every 10 min)</p>
                    <p style="margin-bottom: 0.375rem;"><strong>Backup:</strong> CPCB, OpenAQ, IQAir</p>
                    <p style="margin-bottom: 0.375rem;"><strong>Health:</strong> IHME GBD, Lancet, WHO</p>
                    <p style="margin-bottom: 0.375rem;"><strong>News:</strong> Google News RSS</p>
                    <p><strong>Research:</strong> TERI, IIT Delhi, CSE</p>
                    <hr style="margin: 0.5rem 0; border: none; border-top: 1px solid var(--border);">
                    <p style="font-size: 0.5625rem; color: var(--text-3);">Get your own API token: <a href="https://aqicn.org/data-platform/token/" target="_blank" style="color: var(--primary);">aqicn.org</a></p>
                </div>
            </div>
        </aside>
    </main>

    <footer class="footer">
        <div class="footer-inner">
            <span>Vayu Smriti ‚Äî Citizen-led initiative by Dr. Manmohan Singh Fellows</span>
            <div class="footer-links">
                <a href="#">About</a>
                <a href="#">Contribute</a>
                <a href="https://github.com/Varnasr/vayu-smriti">GitHub</a>
            </div>
        </div>
    </footer>

    <script>
        // ========================================
        // CONFIGURATION - API KEYS
        // ========================================
        // WAQI API - Get your free token at: https://aqicn.org/data-platform/token/
        // Replace 'demo' with your actual token for production use
        const WAQI_TOKEN = 'demo'; // Free tier: 1000 requests/second
        
        // City configurations with WAQI station IDs/names
        const CITY_CONFIG = [
            { name: 'Delhi', query: 'delhi', stationId: '@7024' },
            { name: 'Mumbai', query: 'mumbai', stationId: '@8526' },
            { name: 'Kolkata', query: 'kolkata', stationId: '@8539' },
            { name: 'Chennai', query: 'chennai', stationId: '@11350' },
            { name: 'Bengaluru', query: 'bangalore', stationId: '@8544' },
            { name: 'Hyderabad', query: 'hyderabad', stationId: '@8545' },
            { name: 'Patna', query: 'patna', stationId: '@9798' },
            { name: 'Lucknow', query: 'lucknow', stationId: '@8547' },
            { name: 'Varanasi', query: 'varanasi', stationId: '@11353' },
            { name: 'Ahmedabad', query: 'ahmedabad', stationId: '@8549' },
            { name: 'Noida', query: 'noida', stationId: '@9020' },
            { name: 'Gurugram', query: 'gurgaon', stationId: '@9619' }
        ];

        // Live AQI data store
        let aqiData = {};
        let lastUpdate = null;
        let fetchErrors = 0;

        // ========================================
        // THEME & LANGUAGE
        // ========================================
        function toggleTheme() {
            const html = document.documentElement;
            const isDark = html.getAttribute('data-theme') === 'dark';
            html.setAttribute('data-theme', isDark ? 'light' : 'dark');
            localStorage.setItem('theme', isDark ? 'light' : 'dark');
            initCharts();
        }

        function setLang(lang) {
            document.documentElement.setAttribute('data-lang', lang);
            localStorage.setItem('lang', lang);
        }

        // ========================================
        // PANEL NAVIGATION
        // ========================================
        function showPanel(panel) {
            document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            document.getElementById('panel-' + panel).classList.add('active');
            event.target.closest('.nav-item').classList.add('active');
            if (panel === 'data' || panel === 'news') initCharts();
        }

        // ========================================
        // AQI CLASSIFICATION
        // ========================================
        function getAQIClass(aqi) {
            if (aqi <= 50) return 'good';
            if (aqi <= 100) return 'mod';
            if (aqi <= 200) return 'poor';
            if (aqi <= 300) return 'vpoor';
            if (aqi <= 400) return 'severe';
            return 'hazard';
        }

        function getAQILabel(aqi) {
            if (aqi <= 50) return 'Good';
            if (aqi <= 100) return 'Moderate';
            if (aqi <= 200) return 'Poor';
            if (aqi <= 300) return 'Very Poor';
            if (aqi <= 400) return 'Severe';
            return 'Hazardous';
        }

        // ========================================
        // LIVE AQI FETCH - WAQI API
        // ========================================
        async function fetchAQIForCity(city) {
            try {
                // Try city name query first (more reliable)
                const response = await fetch(`https://api.waqi.info/feed/${city.query}/?token=${WAQI_TOKEN}`);
                const data = await response.json();
                
                if (data.status === 'ok' && data.data && data.data.aqi !== '-') {
                    return {
                        name: city.name,
                        aqi: parseInt(data.data.aqi),
                        class: getAQIClass(parseInt(data.data.aqi)),
                        pm25: data.data.iaqi?.pm25?.v || null,
                        pm10: data.data.iaqi?.pm10?.v || null,
                        time: data.data.time?.s || new Date().toISOString(),
                        station: data.data.city?.name || city.name,
                        source: 'WAQI'
                    };
                }
                throw new Error('Invalid data');
            } catch (e) {
                console.warn(`Failed to fetch AQI for ${city.name}:`, e);
                return null;
            }
        }

        async function fetchAllAQI() {
            const ticker = document.getElementById('aqi-ticker');
            const updateEl = document.getElementById('ticker-update');
            
            ticker.innerHTML = '<div class="ticker-item"><span class="ticker-city">Fetching live data...</span></div>';
            updateEl.textContent = 'Connecting to WAQI API...';

            const results = await Promise.allSettled(
                CITY_CONFIG.map(city => fetchAQIForCity(city))
            );

            let successCount = 0;
            results.forEach((result, index) => {
                if (result.status === 'fulfilled' && result.value) {
                    aqiData[CITY_CONFIG[index].name] = result.value;
                    successCount++;
                } else {
                    // Keep old data or use fallback
                    if (!aqiData[CITY_CONFIG[index].name]) {
                        aqiData[CITY_CONFIG[index].name] = {
                            name: CITY_CONFIG[index].name,
                            aqi: '--',
                            class: 'mod',
                            source: 'Offline'
                        };
                    }
                }
            });

            lastUpdate = new Date();
            fetchErrors = CITY_CONFIG.length - successCount;

            updateTicker();
            updateLiveGrid();
            updateChartData();

            if (successCount === 0) {
                updateEl.innerHTML = `<span style="color: var(--health);">‚ö† API Error - Using cached data</span>`;
                loadFallbackData();
            } else if (fetchErrors > 0) {
                updateEl.innerHTML = `Updated: ${lastUpdate.toLocaleTimeString()} <span style="color: var(--accent);">(${successCount}/${CITY_CONFIG.length} cities)</span>`;
            } else {
                updateEl.textContent = `‚úì Live: ${lastUpdate.toLocaleTimeString()}`;
            }
        }

        function loadFallbackData() {
            // Fallback static data when API fails
            const fallback = {
                'Delhi': { aqi: 285, class: 'vpoor' },
                'Mumbai': { aqi: 142, class: 'mod' },
                'Kolkata': { aqi: 178, class: 'poor' },
                'Chennai': { aqi: 98, class: 'mod' },
                'Bengaluru': { aqi: 87, class: 'mod' },
                'Hyderabad': { aqi: 112, class: 'mod' },
                'Patna': { aqi: 342, class: 'severe' },
                'Lucknow': { aqi: 267, class: 'vpoor' },
                'Varanasi': { aqi: 289, class: 'vpoor' },
                'Ahmedabad': { aqi: 156, class: 'poor' },
                'Noida': { aqi: 312, class: 'severe' },
                'Gurugram': { aqi: 298, class: 'vpoor' }
            };
            Object.entries(fallback).forEach(([city, data]) => {
                aqiData[city] = { name: city, ...data, source: 'Cached' };
            });
            updateTicker();
            updateLiveGrid();
        }

        function updateTicker() {
            const ticker = document.getElementById('aqi-ticker');
            const entries = Object.entries(aqiData).filter(([_, d]) => d.aqi !== '--');
            
            if (entries.length === 0) {
                ticker.innerHTML = '<div class="ticker-item"><span class="ticker-city">No data available</span></div>';
                return;
            }

            ticker.innerHTML = entries.map(([city, data]) => 
                `<div class="ticker-item" title="${data.station || city} via ${data.source || 'API'}">
                    <span class="ticker-city">${city}</span>
                    <span class="ticker-aqi ${data.class}">${data.aqi}</span>
                </div>`
            ).join('');
        }

        function updateLiveGrid() {
            const grid = document.getElementById('live-aqi-grid');
            if (!grid) return;
            
            const entries = Object.entries(aqiData);
            grid.innerHTML = entries.map(([city, data]) => `
                <div style="background: var(--bg); padding: 0.625rem; border-radius: 6px; text-align: center; border: 1px solid var(--border);">
                    <div style="font-size: 0.6875rem; color: var(--text-2); margin-bottom: 0.25rem;">${city}</div>
                    <div style="font-size: 1.5rem; font-weight: 700; color: var(--aqi-${data.class});">${data.aqi}</div>
                    <div style="font-size: 0.5625rem; color: var(--text-3);">${getAQILabel(data.aqi)}</div>
                    ${data.pm25 ? `<div style="font-size: 0.5625rem; color: var(--text-3); margin-top: 0.25rem;">PM2.5: ${data.pm25}</div>` : ''}
                </div>
            `).join('');
        }

        function updateChartData() {
            // Update metro chart with live data
            if (charts.metro && charts.metro.data) {
                const cities = ['Delhi', 'Mumbai', 'Kolkata', 'Chennai', 'Bengaluru', 'Hyderabad'];
                charts.metro.data.datasets[0].data = cities.map(c => aqiData[c]?.aqi || 0);
                charts.metro.data.datasets[0].backgroundColor = cities.map(c => {
                    const cls = aqiData[c]?.class || 'mod';
                    const colors = { good: '#22C55E', mod: '#EAB308', poor: '#F97316', vpoor: '#EF4444', severe: '#7C3AED', hazard: '#831843' };
                    return colors[cls];
                });
                charts.metro.update('none');
            }
        }

        // ========================================
        // NEWS FEED - RSS
        // ========================================
        async function fetchNews() {
            const feed = document.getElementById('news-feed');
            try {
                // Multiple RSS feeds via proxy
                const sources = [
                    { name: 'Google News', url: 'https://news.google.com/rss/search?q=delhi+air+pollution&hl=en-IN&gl=IN&ceid=IN:en' },
                    { name: 'Down to Earth', url: 'https://www.downtoearth.org.in/rss/air' }
                ];
                
                // Use RSS2JSON API (free tier)
                const response = await fetch(`https://api.rss2json.com/v1/api.json?rss_url=${encodeURIComponent(sources[0].url)}&api_key=demo&count=8`);
                const data = await response.json();
                
                if (data.status === 'ok' && data.items) {
                    feed.innerHTML = data.items.slice(0, 8).map(item => `
                        <div class="news-item">
                            <div class="news-source">${item.author || 'News'}</div>
                            <div class="news-title"><a href="${item.link}" target="_blank">${item.title}</a></div>
                            <div class="news-meta">${new Date(item.pubDate).toLocaleDateString('en-IN', { day: 'numeric', month: 'short', year: 'numeric' })}</div>
                        </div>
                    `).join('');
                } else {
                    throw new Error('RSS fetch failed');
                }
            } catch (e) {
                // Fallback to static curated news
                feed.innerHTML = `
                    <div class="news-item">
                        <div class="news-source">IQAir</div>
                        <div class="news-title"><a href="https://www.iqair.com/newsroom/december-15-2025-delhi-among-top-10-most-polluted-cities-in-the-world" target="_blank">Delhi Among Top 10 Most Polluted Cities in the World</a></div>
                        <div class="news-meta">15 Dec 2025</div>
                    </div>
                    <div class="news-item">
                        <div class="news-source">AQI.in</div>
                        <div class="news-title"><a href="https://www.aqi.in/blog/delhi-air-quality-2025-zero-good-days/" target="_blank">Delhi's Air in 2025: Zero Good Days</a></div>
                        <div class="news-meta">27 Dec 2025</div>
                    </div>
                    <div class="news-item">
                        <div class="news-source">Down to Earth</div>
                        <div class="news-title"><a href="https://www.downtoearth.org.in/air/from-episodic-smog-to-structural-pollution-why-vehicles-remain-delhis-biggest-challenge" target="_blank">Why Vehicles Remain Delhi's Biggest Challenge</a></div>
                        <div class="news-meta">23 Dec 2025</div>
                    </div>
                    <div class="news-item">
                        <div class="news-source">India.com</div>
                        <div class="news-title"><a href="https://www.india.com/news/india/poison-has-spread-in-delhi-ncr-run-away-to-safe-places-social-media-flooded-with-messages-on-pollution-and-aqi-supreme-court-reddit-aiims-pm2-5-heart-attack-blood-pressure-8232481/" target="_blank">'Poison Has Spread in Delhi-NCR' ‚Äî Social Media Viral</a></div>
                        <div class="news-meta">Dec 2025</div>
                    </div>
                    <div class="news-item">
                        <div class="news-source">Deccan Herald</div>
                        <div class="news-title"><a href="https://www.deccanherald.com/india/delhi/superman-in-oxygen-mask-weddings-in-icu-delhiites-turn-to-memes-satire-amid-pollution-crisis-3793028" target="_blank">Weddings in ICU: Delhiites Turn to Memes Amid Pollution Crisis</a></div>
                        <div class="news-meta">10 Nov 2025</div>
                    </div>
                `;
            }
        }

        // ========================================
        // CHARTS
        // ========================================
        let charts = {};
        function initCharts() {
            const isDark = document.documentElement.getAttribute('data-theme') === 'dark';
            const textColor = isDark ? '#94A3B8' : '#64748B';
            const gridColor = isDark ? '#334155' : '#E2E8F0';
            const opts = { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } }, scales: { y: { beginAtZero: true, ticks: { color: textColor, font: { size: 10 } }, grid: { color: gridColor } }, x: { ticks: { color: textColor, font: { size: 10 } }, grid: { display: false } } } };

            // Destroy existing charts before recreating
            Object.values(charts).forEach(c => c?.destroy?.());
            charts = {};

            if (document.getElementById('metroChart')) {
                const cities = ['Delhi', 'Mumbai', 'Kolkata', 'Chennai', 'Bengaluru', 'Hyderabad'];
                const values = cities.map(c => aqiData[c]?.aqi || 0);
                const colors = cities.map(c => {
                    const cls = aqiData[c]?.class || 'mod';
                    const colorMap = { good: '#22C55E', mod: '#EAB308', poor: '#F97316', vpoor: '#EF4444', severe: '#7C3AED', hazard: '#831843' };
                    return colorMap[cls];
                });
                charts.metro = new Chart(document.getElementById('metroChart'), {
                    type: 'bar',
                    data: { labels: cities, datasets: [{ data: values, backgroundColor: colors }] },
                    options: { ...opts, scales: { ...opts.scales, y: { ...opts.scales.y, max: 500 } } }
                });
            }
            if (document.getElementById('regionChart')) {
                charts.region = new Chart(document.getElementById('regionChart'), {
                    type: 'bar',
                    data: { labels: ['Delhi', 'Lucknow', 'Patna', 'Chennai', 'Bengaluru', 'Hyderabad'], datasets: [{ label: 'North', data: [aqiData['Delhi']?.aqi || 285, aqiData['Lucknow']?.aqi || 267, aqiData['Patna']?.aqi || 342, null, null, null], backgroundColor: '#EF4444' }, { label: 'South', data: [null, null, null, aqiData['Chennai']?.aqi || 98, aqiData['Bengaluru']?.aqi || 87, aqiData['Hyderabad']?.aqi || 112], backgroundColor: '#22C55E' }] },
                    options: { ...opts, plugins: { legend: { display: true, position: 'top', labels: { boxWidth: 12, font: { size: 10 } } } }, scales: { ...opts.scales, y: { ...opts.scales.y, max: 400 } } }
                });
            }
            if (document.getElementById('ruralChart')) {
                charts.rural = new Chart(document.getElementById('ruralChart'), {
                    type: 'bar',
                    data: { labels: ['Patna', 'Varanasi', 'Rural Bihar', 'Lucknow', 'Delhi', 'Rural UP'], datasets: [{ data: [aqiData['Patna']?.aqi || 342, aqiData['Varanasi']?.aqi || 289, 195, aqiData['Lucknow']?.aqi || 267, aqiData['Delhi']?.aqi || 285, 165], backgroundColor: ['#7C3AED', '#EF4444', '#22C55E', '#F97316', '#EF4444', '#22C55E'] }] },
                    options: { ...opts, scales: { ...opts.scales, y: { ...opts.scales.y, max: 450 } } }
                });
            }
            if (document.getElementById('delhiChart')) {
                charts.delhi = new Chart(document.getElementById('delhiChart'), {
                    type: 'line',
                    data: { labels: ['1', '5', '10', '13', '14', '17', '20', '24', '27', 'Now'], datasets: [{ data: [245, 289, 356, 425, 461, 398, 312, 271, 285, aqiData['Delhi']?.aqi || 285], borderColor: '#7C3AED', backgroundColor: 'rgba(124,58,237,0.1)', fill: true, tension: 0.4, pointRadius: [2,2,2,2,2,2,2,2,2,5], pointBackgroundColor: ['#7C3AED','#7C3AED','#7C3AED','#7C3AED','#7C3AED','#7C3AED','#7C3AED','#7C3AED','#7C3AED','#EF4444'] }] },
                    options: { ...opts, scales: { ...opts.scales, y: { ...opts.scales.y, max: 500 } } }
                });
            }
        }

        // ========================================
        // MANUAL REFRESH BUTTON
        // ========================================
        async function manualRefresh() {
            const btn = event.target;
            btn.disabled = true;
            btn.textContent = 'Refreshing...';
            await fetchAllAQI();
            await fetchNews();
            btn.disabled = false;
            btn.textContent = '‚Üª Refresh Now';
        }

        // ========================================
        // INITIALIZATION
        // ========================================
        document.addEventListener('DOMContentLoaded', async () => {
            // Load saved preferences
            const savedTheme = localStorage.getItem('theme');
            const savedLang = localStorage.getItem('lang');
            if (savedTheme === 'dark') document.documentElement.setAttribute('data-theme', 'dark');
            if (savedLang) {
                document.documentElement.setAttribute('data-lang', savedLang);
                document.querySelector('.lang-select').value = savedLang;
            }

            // Initial data fetch
            await fetchAllAQI();
            fetchNews();
            initCharts();

            // Auto-refresh every 10 minutes (WAQI updates ~hourly, but we check more frequently)
            setInterval(async () => {
                await fetchAllAQI();
                fetchNews();
            }, 10 * 60 * 1000);

            console.log('Vayu Smriti initialized. AQI data refreshes every 10 minutes.');
            console.log('Data source: World Air Quality Index (WAQI) - https://waqi.info');
        });
    </script>
</body>
</html>
